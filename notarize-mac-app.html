<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><meta name="description" content="My personal website where I keep my notes and thoughts."/><meta name="og:title" content="Paul Treanor"/><meta name="twitter:card" content="summary_large_image"/><link rel="alternate" type="application/rss+xml" title="RSS Feed for paultreanor.com" href="/rss.xml"/><title>Notarizing Electron Apps for MacOS</title><meta name="next-head-count" content="8"/><link rel="preload" href="/_next/static/css/a9ba2434b92ee57b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a9ba2434b92ee57b.css" data-n-g=""/><link rel="preload" href="/_next/static/css/d0f3a9e7dfd4b19b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d0f3a9e7dfd4b19b.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-481ef0d25a716735.js" defer=""></script><script src="/_next/static/chunks/pages/_app-1693ab7fc31cdd21.js" defer=""></script><script src="/_next/static/chunks/562-d0bcd15ec5190dc9.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bid%5D-331c202ad6dd6bd9.js" defer=""></script><script src="/_next/static/tPtWSm8bjR8tEUZezNiLj/_buildManifest.js" defer=""></script><script src="/_next/static/tPtWSm8bjR8tEUZezNiLj/_ssgManifest.js" defer=""></script></head><body><div id="__next"><script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script><script nomodule="" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script><div class="mx-2 md:mx-20 lg:mx-40 font-open-sans mb-32"><header class="max-w-2xl mx-auto"><div class="mt-10 mb-8"><a href="/"><div class="text-4xl">üè†</div></a></div></header><main><div class="max-w-2xl mx-auto"><h5 class="text-slate-600 font-normal mb-5"><time dateTime="2023-08-29">August 29, 2023</time></h5><div class="blog-content"><h1>Notarizing Electron Apps for MacOS</h1>
<p>Notarizing is an automated process by Apple that ensures your application is safe and compatible with MacOS. It involves sending a copy of your app to Apple's system, and then waiting for a response to hopefully say all is good.</p>
<p>All MacOS apps must be code-signed and notarized or else users won't be able to install them.</p>
<h3>Prerequisites</h3>
<p>Before you can notarize your app, you need to join the Apple Developer Program which costs ‚Ç¨100/year (a not-so-nice gatekeeping measure from Apple). Then you'll need to set up some Apple Developer Program certificates in your Keychain. <a href="https://www.rocketride.io/blog/macos-code-sign-notarize-electron-app">This RocketRide blog post</a> is a helpful guide through this painful process.</p>
<p>Mercifully these steps are a one-time ordeal for your first MacOS app. For subsequent apps, <a href="https://www.electron.build/code-signing.html">electron-builder should handle code-signing</a> as part of its build process so long as your Keychain credentials are set up correctly.</p>
<h3>Notarizing</h3>
<p>The <a href="https://github.com/electron/notarize">Electron Notarize</a> npm module is helpful here. To use the module create the files <em>notarize.js</em> and <em>.env</em>. <strong>You must add <em>.env</em> to your <code>.gitignore</code> file</strong> as it contains secrets that you don't want to commit to your GitHub repo.</p>
<p><strong>notarize.js</strong></p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> { notarize } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@electron/notarize'</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">'dotenv'</span>).<span class="hljs-title function_">config</span>();

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">packageTask</span> () {
	<span class="hljs-keyword">const</span> options = {
		<span class="hljs-attr">appBundleId</span>: <span class="hljs-string">'your.bundle.name'</span>, <span class="hljs-comment">// Unique ID in form `com.paultreanor.promptmarker`</span>
		<span class="hljs-attr">appPath</span>: <span class="hljs-string">'./path/to/yourAppName.dmg'</span>, <span class="hljs-comment">// Probably in `/release` or `/dist`</span>
		<span class="hljs-attr">appleId</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">APPLE_ID</span>, <span class="hljs-comment">// Should be an email</span>
		<span class="hljs-attr">appleIdPassword</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">APPLE_ID_PASSWORD</span>, <span class="hljs-comment">// Read electron/notarize README doc (app specific password)</span>
		<span class="hljs-attr">teamId</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">TEAM_ID</span>
	};
	<span class="hljs-comment">// Log your options to make sure everything looks OK - be careful as this will print your secrets</span>
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>({options})
	<span class="hljs-keyword">try</span> {
		<span class="hljs-keyword">await</span> <span class="hljs-title function_">notarize</span>(options);
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Notarization complete"</span>)
		} <span class="hljs-keyword">catch</span> (error) {
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Error during notarization: "</span>, error);
	}
}

<span class="hljs-title function_">packageTask</span>();
</code></pre>
<p><strong>.env</strong></p>
<pre><code class="hljs language-text">APPLE_ID=myappleid@gmail.com
APPLE_ID_PASSWORD=xxxx-xxxx-xxxx-xxxx
TEAM_ID=XXXXXXXXXX 
</code></pre>
<p>You'll need to follow <a href="https://support.apple.com/en-us/HT204397">these instructions</a> to create an app specific password. Just write in the name of your app and you'll get a 16 digit password for it.</p>
<p>Fill in the <code>options</code> arguments and then run the script after running your build process:</p>
<pre><code class="hljs language-bash">npm run build
node notarize.js
</code></pre>
<p>This can take a few minutes to run and you'll either get an error message from Apple or it will run successfully.</p>
<h3>Verification and Stapling</h3>
<p>You can check that your file is notarized correctly by running the following:</p>
<pre><code class="hljs language-bash">spctl -a -t <span class="hljs-built_in">exec</span> -vv YourApp.dmg
</code></pre>
<p>You can staple the notarization ticket directly to your <code>dmg</code> file so it can be verified by Apple even if the user installs it offline:</p>
<pre><code class="hljs language-bash">xcrun stapler staple <span class="hljs-string">"YourApp.dmg"</span>
</code></pre>
<p>These commands also work with <code>.app</code> files if you'd rather distribute those instead.</p>
<p>And there you have it, now you can distribute your app for people to download and install it üëè</p></div></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"notarize-mac-app","contentHtml":"\u003ch1\u003eNotarizing Electron Apps for MacOS\u003c/h1\u003e\n\u003cp\u003eNotarizing is an automated process by Apple that ensures your application is safe and compatible with MacOS. It involves sending a copy of your app to Apple's system, and then waiting for a response to hopefully say all is good.\u003c/p\u003e\n\u003cp\u003eAll MacOS apps must be code-signed and notarized or else users won't be able to install them.\u003c/p\u003e\n\u003ch3\u003ePrerequisites\u003c/h3\u003e\n\u003cp\u003eBefore you can notarize your app, you need to join the Apple Developer Program which costs ‚Ç¨100/year (a not-so-nice gatekeeping measure from Apple). Then you'll need to set up some Apple Developer Program certificates in your Keychain. \u003ca href=\"https://www.rocketride.io/blog/macos-code-sign-notarize-electron-app\"\u003eThis RocketRide blog post\u003c/a\u003e is a helpful guide through this painful process.\u003c/p\u003e\n\u003cp\u003eMercifully these steps are a one-time ordeal for your first MacOS app. For subsequent apps, \u003ca href=\"https://www.electron.build/code-signing.html\"\u003eelectron-builder should handle code-signing\u003c/a\u003e as part of its build process so long as your Keychain credentials are set up correctly.\u003c/p\u003e\n\u003ch3\u003eNotarizing\u003c/h3\u003e\n\u003cp\u003eThe \u003ca href=\"https://github.com/electron/notarize\"\u003eElectron Notarize\u003c/a\u003e npm module is helpful here. To use the module create the files \u003cem\u003enotarize.js\u003c/em\u003e and \u003cem\u003e.env\u003c/em\u003e. \u003cstrong\u003eYou must add \u003cem\u003e.env\u003c/em\u003e to your \u003ccode\u003e.gitignore\u003c/code\u003e file\u003c/strong\u003e as it contains secrets that you don't want to commit to your GitHub repo.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003enotarize.js\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { notarize } = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'@electron/notarize'\u003c/span\u003e);\n\u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'dotenv'\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003econfig\u003c/span\u003e();\n\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003epackageTask\u003c/span\u003e () {\n\t\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e options = {\n\t\t\u003cspan class=\"hljs-attr\"\u003eappBundleId\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'your.bundle.name'\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e// Unique ID in form `com.paultreanor.promptmarker`\u003c/span\u003e\n\t\t\u003cspan class=\"hljs-attr\"\u003eappPath\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'./path/to/yourAppName.dmg'\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e// Probably in `/release` or `/dist`\u003c/span\u003e\n\t\t\u003cspan class=\"hljs-attr\"\u003eappleId\u003c/span\u003e: process.\u003cspan class=\"hljs-property\"\u003eenv\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eAPPLE_ID\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e// Should be an email\u003c/span\u003e\n\t\t\u003cspan class=\"hljs-attr\"\u003eappleIdPassword\u003c/span\u003e: process.\u003cspan class=\"hljs-property\"\u003eenv\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eAPPLE_ID_PASSWORD\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e// Read electron/notarize README doc (app specific password)\u003c/span\u003e\n\t\t\u003cspan class=\"hljs-attr\"\u003eteamId\u003c/span\u003e: process.\u003cspan class=\"hljs-property\"\u003eenv\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eTEAM_ID\u003c/span\u003e\n\t};\n\t\u003cspan class=\"hljs-comment\"\u003e// Log your options to make sure everything looks OK - be careful as this will print your secrets\u003c/span\u003e\n\t\u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e({options})\n\t\u003cspan class=\"hljs-keyword\"\u003etry\u003c/span\u003e {\n\t\t\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003enotarize\u003c/span\u003e(options);\n\t\t\u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Notarization complete\"\u003c/span\u003e)\n\t\t} \u003cspan class=\"hljs-keyword\"\u003ecatch\u003c/span\u003e (error) {\n\t\t\u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eerror\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Error during notarization: \"\u003c/span\u003e, error);\n\t}\n}\n\n\u003cspan class=\"hljs-title function_\"\u003epackageTask\u003c/span\u003e();\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e.env\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-text\"\u003eAPPLE_ID=myappleid@gmail.com\nAPPLE_ID_PASSWORD=xxxx-xxxx-xxxx-xxxx\nTEAM_ID=XXXXXXXXXX \n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou'll need to follow \u003ca href=\"https://support.apple.com/en-us/HT204397\"\u003ethese instructions\u003c/a\u003e to create an app specific password. Just write in the name of your app and you'll get a 16 digit password for it.\u003c/p\u003e\n\u003cp\u003eFill in the \u003ccode\u003eoptions\u003c/code\u003e arguments and then run the script after running your build process:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003enpm run build\nnode notarize.js\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis can take a few minutes to run and you'll either get an error message from Apple or it will run successfully.\u003c/p\u003e\n\u003ch3\u003eVerification and Stapling\u003c/h3\u003e\n\u003cp\u003eYou can check that your file is notarized correctly by running the following:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003espctl -a -t \u003cspan class=\"hljs-built_in\"\u003eexec\u003c/span\u003e -vv YourApp.dmg\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou can staple the notarization ticket directly to your \u003ccode\u003edmg\u003c/code\u003e file so it can be verified by Apple even if the user installs it offline:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003excrun stapler staple \u003cspan class=\"hljs-string\"\u003e\"YourApp.dmg\"\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThese commands also work with \u003ccode\u003e.app\u003c/code\u003e files if you'd rather distribute those instead.\u003c/p\u003e\n\u003cp\u003eAnd there you have it, now you can distribute your app for people to download and install it üëè\u003c/p\u003e","title":"Notarizing Electron Apps for MacOS","short":"Guide to notarizing electron apps for MacOS","date":"2023-08-29","slug":"notarize","createdAt":"2023-08-29","img":"blog-2.jpg","tags":["Tutorial"]}},"__N_SSG":true},"page":"/[id]","query":{"id":"notarize-mac-app"},"buildId":"tPtWSm8bjR8tEUZezNiLj","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>