<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><meta name="description" content="My personal website where I keep my notes and thoughts."/><meta name="og:title" content="Paul Treanor"/><meta name="twitter:card" content="summary_large_image"/><link rel="alternate" type="application/rss+xml" title="RSS Feed for paultreanor.com" href="/rss.xml"/><title>Low-Hanging Fruits of JS build and test times</title><meta name="next-head-count" content="8"/><link rel="preload" href="/_next/static/css/a0a5c827be6f67e6.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/a0a5c827be6f67e6.css" crossorigin="" data-n-g=""/><link rel="preload" href="/_next/static/css/d0f3a9e7dfd4b19b.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/d0f3a9e7dfd4b19b.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-fd8027ecb5121007.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-0c7baedefba6b077.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-c52fd4c6b732ab84.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-59b1c5d7bb30336f.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/640-888c0c029cd5a029.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/%5Bid%5D-8387bc9bd40ac31b.js" defer="" crossorigin=""></script><script src="/_next/static/gpKpQlPeTePaY98tJwXrE/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/gpKpQlPeTePaY98tJwXrE/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script><script nomodule="" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script><div class="mx-2 md:mx-20 lg:mx-40 font-open-sans mb-32"><header class="max-w-2xl mx-auto"><div class="mt-10 mb-8"><a href="/"><div class="text-4xl">üè†</div></a></div></header><main><div class="max-w-2xl mx-auto"><h5 class="text-slate-600 font-normal mb-5"><time dateTime="2025-02-19">February 19, 2025</time></h5><div class="blog-content"><h1>Low-Hanging Fruits of JS build and test times</h1>
<h3>Speeding up Jest test suite</h3>
<p>The InsightAppSec frontend has about 4000 unit tests written in Jest. Depending on whether or not your laptop's plugged in, they take in or around 6 minutes to run. I recently spent an afternoon doing some benchmarking to try and make them run faster.</p>
<p>Using Node 20 instead of Node 18 made the test suite run 35% faster (5m31s to 3m21s), which is a really nice improvement.</p>
<p>Running tests selectively based on git changes (<code class="inline-code-custom-style">jest --onlyChanged</code>) has no downsides for regular inner-loop software development (all the tests will still be run on the CI pipeline). But this small change brought the average run time down to about a minute, depending on how many files I've changed.</p>
<h3>Speeding up webpack local dev server</h3>
<p>Configuring webpack to use caching when running a local dev server took <code class="inline-code-custom-style">npm run dev</code> from taking 1 minute 40 seconds to run, to taking 12 seconds to run. It works by effectively making <code class="inline-code-custom-style">npm run dev</code> use HMR from cold.</p>
<h3>Leverage existing boring tools</h3>
<p>I couldn't believe how much faster these really simple changes made the build and test times. Moving the test suite from Jest to Vitest would probably have taken me a month, and the same goes for swapping webpack with RSpack or Vite (we use a good few plugins).</p>
<p>In the future I'm going to be a bit more wary about big build/test tool migrations for performance reasons because there's still a lot of low-hanging fruit with these slightly older tools. It is well worth doing a bit of profiling before doing a costly tooling migration.</p>
<p>In the meantime I'm enjoying the speedups. I get an hour or so back every week and running tests doesn't take me out of that nice flow state quite like it used to.</p></div></div></main></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"postData":{"id":"js-performance","contentHtml":"\u003ch1\u003eLow-Hanging Fruits of JS build and test times\u003c/h1\u003e\n\u003ch3\u003eSpeeding up Jest test suite\u003c/h3\u003e\n\u003cp\u003eThe InsightAppSec frontend has about 4000 unit tests written in Jest. Depending on whether or not your laptop's plugged in, they take in or around 6 minutes to run. I recently spent an afternoon doing some benchmarking to try and make them run faster.\u003c/p\u003e\n\u003cp\u003eUsing Node 20 instead of Node 18 made the test suite run 35% faster (5m31s to 3m21s), which is a really nice improvement.\u003c/p\u003e\n\u003cp\u003eRunning tests selectively based on git changes (\u003ccode class=\"inline-code-custom-style\"\u003ejest --onlyChanged\u003c/code\u003e) has no downsides for regular inner-loop software development (all the tests will still be run on the CI pipeline). But this small change brought the average run time down to about a minute, depending on how many files I've changed.\u003c/p\u003e\n\u003ch3\u003eSpeeding up webpack local dev server\u003c/h3\u003e\n\u003cp\u003eConfiguring webpack to use caching when running a local dev server took \u003ccode class=\"inline-code-custom-style\"\u003enpm run dev\u003c/code\u003e from taking 1 minute 40 seconds to run, to taking 12 seconds to run. It works by effectively making \u003ccode class=\"inline-code-custom-style\"\u003enpm run dev\u003c/code\u003e use HMR from cold.\u003c/p\u003e\n\u003ch3\u003eLeverage existing boring tools\u003c/h3\u003e\n\u003cp\u003eI couldn't believe how much faster these really simple changes made the build and test times. Moving the test suite from Jest to Vitest would probably have taken me a month, and the same goes for swapping webpack with RSpack or Vite (we use a good few plugins).\u003c/p\u003e\n\u003cp\u003eIn the future I'm going to be a bit more wary about big build/test tool migrations for performance reasons because there's still a lot of low-hanging fruit with these slightly older tools. It is well worth doing a bit of profiling before doing a costly tooling migration.\u003c/p\u003e\n\u003cp\u003eIn the meantime I'm enjoying the speedups. I get an hour or so back every week and running tests doesn't take me out of that nice flow state quite like it used to.\u003c/p\u003e","title":"Low-Hanging Fruits of JS build and test times","short":"Simple ways to speed up Jest tests and webpack builds","date":"2025-02-19","slug":"js-build-times","createdAt":"2025-02-19","img":"blog-2.jpg","tags":["Note"]}},"__N_SSG":true},"page":"/[id]","query":{"id":"js-performance"},"buildId":"gpKpQlPeTePaY98tJwXrE","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>